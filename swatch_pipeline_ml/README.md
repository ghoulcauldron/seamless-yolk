# Swatch Pipeline (ML-Enabled)

This project offers an interactive GUI to manually crop swatches from flat lay/ghost garment photos, with logging for future ML automation.

## Features

- Load raw ghost/flat images in a gallery
- Click-and-drag to place a 300x300 crop box (swatch window)
- Save swatch as JPEG named from the product's style tag
- Assign garment type (e.g. pants, sweater) on save
- Log crop coordinates and metadata in JSON for ML training

## Folder Structure

- `inputs/ghosts/` ‚Äî raw garment images
- `outputs/swatches/` ‚Äî final swatch images
- `logs/swatch_hints.json` ‚Äî user-drawn crop locations + metadata
- `config/garment_config.json` ‚Äî presets or bounds per garment type

## Setup

```bash
python -m pip install --upgrade pip
pip install pillow
pip install pyqt5

## Summary of Changes October 18, 2025
Here's a breakdown of the updates based on your requests:

‚úîÔ∏è Filename Fix (#1): The swatch filename now correctly removes _ghost and anything after it.

‚å®Ô∏è "Return" to Save (#2): You can now press the Return or Enter key to save the current swatch and advance to the next image.

üîí Stable Crop Box (#3): Changing the garment type in the dropdown will no longer reset the position of your crop box. The box will only reset to the garment's default position when a new image is loaded.

‚ú® Add Garment Types (#4): A new "Add Type" button allows you to add new garment categories on the fly.

üñºÔ∏è "Zoom to Fit" Preview (#5): You can now press and hold the Tab key to see a scaled-down "zoom to fit" preview of the entire garment. Releasing the key restores the full-resolution view. NOTE: This is a WIP; currently a tab press merely centers the image in the preview.

üìù Filename in Title (#6): The current image's filename is now displayed in the window's title bar for easy reference.

üñ±Ô∏è Click to Reposition (#7): You can now click anywhere on the image to instantly move the center of the crop box to that point.

## Next Development Phase: API Integration and Automation

The next phase of this project will focus on leveraging the Shopify API to fully automate the product enrichment and merchandising setup process. This will circumvent the limitations of the native CSV importer and enable a more robust, scalable workflow.

### Key Objectives:

1.  **API-Based Metafield Updates:**
    * Develop a script to update product metafields directly via the Shopify API.
    * This will specifically target the population of file-reference metafields, including `Swatch: Image (product.metafields.altuzarra.swatch_image)` and `Get the look image (product.metafields.altuzarra.look_image)`, which cannot be handled by the CSV import process.
    * Serve as a pilot project for automating the management of other product attributes currently handled via CSV, such as parent/variant image assignments, the generation of collection tags, allowed metafields,

2.  **Automated Smart Collection Creation:**
    * Create a script that uses the Shopify API to perform bulk creation of smart collections.
    * For each unique `style_Style Name` tag generated by the enrichment script, a corresponding smart collection will be created.
    * The collection's rule will be automatically set with the condition: `Tag is equal to style_Style Name`.
```